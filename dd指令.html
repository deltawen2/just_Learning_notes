<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>dd指令</title>
  <link rel="stylesheet" href="https://stackedit.cn/style.css" />
  <style type="text/css">
    .app--dark {
      background-color: #444;
    }
    .app--dark .stackedit__html {
      padding-left: 0;
      padding-right: 0;
    }
    .app--dark .stackedit__content {
      padding: 1px 20px 20px;
    }
    
  </style>
</head>

<body class="stackedit app--dark">
  <div class="stackedit__left">
    <div class="stackedit__toc">
      
<ul>
<li><a href="#dd-是-linux-中非常強大的低階資料處理工具，常用於磁碟備份、映像製作、資料轉換等。以下是完整的說明與範例：">dd 是 Linux 中非常強大的低階資料處理工具，常用於磁碟備份、映像製作、資料轉換等。以下是完整的說明與範例：</a>
<ul>
<li><a href="#🧠-基本語法">🧠 基本語法</a></li>
<li><a href="#🧪-常見用途與範例">🧪 常見用途與範例</a></li>
<li><a href="#🧪-性能測試範例">🧪 性能測試範例</a></li>
<li><a href="#備份到別台電腦">備份到別台電腦</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  <div class="stackedit__right">
    <div class="stackedit__html">
      <div class="stackedit__content preview-theme--default">
        <h1 id="dd-是-linux-中非常強大的低階資料處理工具，常用於磁碟備份、映像製作、資料轉換等。以下是完整的說明與範例："><span class="prefix"></span><span class="content"><code>dd</code> 是 Linux 中非常強大的低階資料處理工具，常用於磁碟備份、映像製作、資料轉換等。以下是完整的說明與範例：</span><span class="suffix"></span></h1>
<hr>
<h2 id="🧠-基本語法"><span class="prefix"></span><span class="content">🧠 基本語法</span><span class="suffix"></span></h2>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span><span class="token operator">&lt;</span>來源<span class="token operator">&gt;</span> of<span class="token operator">=</span><span class="token operator">&lt;</span>目的<span class="token operator">&gt;</span> <span class="token punctuation">[</span>參數<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre>
<h2 id="🧪-常見用途與範例"><span class="prefix"></span><span class="content">🧪 常見用途與範例</span><span class="suffix"></span></h2>
<h3 id="🔹-建立空白檔案（填充-0）"><span class="prefix"></span><span class="content">🔹 建立空白檔案（填充 0）</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>/dev/zero of<span class="token operator">=</span>empty_100MB.bin bs<span class="token operator">=</span>1M count<span class="token operator">=</span>100
</code></pre>
<h3 id="🔹-建立隨機檔案（填充亂數）"><span class="prefix"></span><span class="content">🔹 建立隨機檔案（填充亂數）</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>/dev/urandom of<span class="token operator">=</span>random_10MB.bin bs<span class="token operator">=</span>1M count<span class="token operator">=</span>10
</code></pre>
<h3 id="🔹-建立稀疏檔案（不實際佔空間）"><span class="prefix"></span><span class="content">🔹 建立稀疏檔案（不實際佔空間）</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>/dev/zero of<span class="token operator">=</span>sparse_1GB.img bs<span class="token operator">=</span>1 count<span class="token operator">=</span>0 seek<span class="token operator">=</span>1G
</code></pre>
<h3 id="🔹-備份整顆硬碟"><span class="prefix"></span><span class="content">🔹 備份整顆硬碟</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>/dev/sda of<span class="token operator">=</span>backup.img bs<span class="token operator">=</span>4M status<span class="token operator">=</span>progress
</code></pre>
<h3 id="🔹-回復硬碟映像"><span class="prefix"></span><span class="content">🔹 回復硬碟映像</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>backup.img of<span class="token operator">=</span>/dev/sda bs<span class="token operator">=</span>4M status<span class="token operator">=</span>progress
</code></pre>
<h3 id="🔹-製作-bootable-usb"><span class="prefix"></span><span class="content">🔹 製作 bootable USB</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>ubuntu.iso of<span class="token operator">=</span>/dev/sdb bs<span class="token operator">=</span>4M status<span class="token operator">=</span>progress
</code></pre>
<h2 id="🧪-性能測試範例"><span class="prefix"></span><span class="content">🧪 性能測試範例</span><span class="suffix"></span></h2>
<h3 id="🔸-測試寫入速度"><span class="prefix"></span><span class="content">🔸 測試寫入速度</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>/dev/zero of<span class="token operator">=</span>testfile bs<span class="token operator">=</span>1G count<span class="token operator">=</span>1 conv<span class="token operator">=</span>fdatasync
</code></pre>
<h3 id="🔸-測試讀取速度"><span class="prefix"></span><span class="content">🔸 測試讀取速度</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>testfile of<span class="token operator">=</span>/dev/null bs<span class="token operator">=</span>1G
</code></pre>
<h2 id="備份到別台電腦"><span class="prefix"></span><span class="content">備份到別台電腦</span><span class="suffix"></span></h2>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>/dev/zero bs<span class="token operator">=</span>4M count<span class="token operator">=</span>250 iflag<span class="token operator">=</span>fullblock <span class="token operator">|</span> <span class="token function">ssh</span> deltawen@192.168.99.7 <span class="token string">"dd of=/dev/shm/testfile bs=4M conv=fdatasync"</span>
</code></pre>
<blockquote>
<p>這串指令做了以下事情：</p>
</blockquote>
<ol>
<li>在本機產生 1GB 的零值資料（全 0 bit）</li>
<li>經由 SSH 傳送到遠端主機（192.168.99.7）</li>
<li>在遠端寫入到 <code>/dev/shm/testfile</code>（RAM-based filesystem）</li>
<li>確保寫入完成後資料 flush 到裝置（雖然是 RAM）</li>
</ol>
<h3 id="分段解析-本機"><span class="prefix"></span><span class="content">分段解析 本機</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> if<span class="token operator">=</span>/dev/zero bs<span class="token operator">=</span>4M count<span class="token operator">=</span>250 iflag<span class="token operator">=</span>fullblock
</code></pre>
<ul>
<li><code>if=/dev/zero</code>：讀取來源資料，全都是零值</li>
<li><code>bs=4M</code>：每個 block 是 4MB</li>
<li><code>count=250</code>：共產生 250 個 blocks → 4MB × 250 = <strong>1GB</strong></li>
<li><code>iflag=fullblock</code>：這很關鍵，確保每次讀滿 block（避免 partial read 警告）<br>
🔸 若沒加 <code>iflag=fullblock</code>，有可能只讀到部分資料（例如 32KB），造成傳送失敗。</li>
</ul>
<h3 id="傳送過程"><span class="prefix"></span><span class="content">傳送過程</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token operator">|</span> <span class="token function">ssh</span> deltawen@192.168.99.7 <span class="token punctuation">..</span>.
</code></pre>
<h3 id="遠端執行部分："><span class="prefix"></span><span class="content">遠端執行部分：</span><span class="suffix"></span></h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">dd</span> of<span class="token operator">=</span>/dev/shm/testfile bs<span class="token operator">=</span>4M conv<span class="token operator">=</span>fdatasync
</code></pre>
<ul>
<li>
<p><code>of=/dev/shm/testfile</code>：寫入到遠端 RAM disk</p>
</li>
<li>
<p><code>bs=4M</code>：一次寫入 4MB chunk</p>
</li>
<li>
<p><code>conv=fdatasync</code>：確保資料 flush 到裝置（在 <code>/dev/shm</code> 中，就是記憶體）</p>
<ul>
<li>雖然是 RAM，<code>fdatasync</code> 確保寫入程序完整結束，可作為資料一致性保證</li>
</ul>
</li>
</ul>

      </div>
    </div>
  </div>
</body>

</html>
